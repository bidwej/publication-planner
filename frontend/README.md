# Paper Planner Frontend

The frontend provides a unified web interface for the Paper Planner system using Dash (Plotly) for interactive visualizations and real-time schedule management.

## Overview

The frontend consists of three main interfaces, all accessible through a single launcher script:

- **Dashboard Mode** (Port 8050): Comprehensive overview with multiple chart types
- **Timeline Mode** (Port 8051): Dedicated Gantt chart visualization  
- **Metrics Mode** (Port 8052): Performance analytics and detailed metrics

## Quick Start

```bash
# Navigate to frontend directory
cd frontend

# Set up environment (copy template and configure paths)
cp env.template .env
# Edit .env to set PYTHONPATH and DATABASE_PATH

# List available interfaces
python run_frontend.py --list

# Launch dashboard (full features)
python run_frontend.py dashboard

# Launch Gantt timeline
python run_frontend.py gantt

# Launch metrics view
python run_frontend.py metrics

# Custom port
python run_frontend.py gantt --port 8060

# Debug mode
python run_frontend.py gantt --debug
```

## Environment Configuration

The frontend requires proper environment configuration for backend imports and database access:

### Required Environment Variables
- **PYTHONPATH**: Set to `../backend/src` for backend module imports

### Setup Steps
1. Copy `env.template` to `.env`
2. Update `PYTHONPATH` to point to `../backend/src`

**Note**: The frontend `env.template` focuses on import paths. Debug mode is controlled via command line arguments (`--debug` flag).

## Interface Features

### Dashboard Mode (Port 8050)
- **Interactive Gantt Charts**: Visual timeline with drag-and-drop capabilities
- **Metrics Visualization**: Real-time charts showing schedule quality and efficiency
- **Schedule Tables**: Detailed tabular views of assignments
- **Violation Reporting**: Real-time constraint violation detection and display
- **Strategy Comparison**: Side-by-side comparison of different scheduling approaches

### Timeline Mode (Port 8051)
- **Gantt Chart Focus**: Dedicated timeline visualization
- **Activity Tracking**: Detailed submission progress tracking
- **Dependency Visualization**: Clear dependency relationships
- **Export Options**: PNG, HTML, and SVG export capabilities

### Metrics Mode (Port 8052)
- **Performance Analytics**: Comprehensive schedule metrics
- **Resource Utilization**: Peak and average resource usage
- **Quality Scoring**: Schedule quality and efficiency analysis
- **Penalty Breakdown**: Detailed constraint violation analysis

## Architecture

### Component Structure
```
app/
├── main.py              # Main Dash application factory
├── models.py            # Web app data models
├── storage.py           # Data persistence and state management
└── components/          # UI components
    ├── dashboard/       # Dashboard components
    │   ├── chart.py     # Dashboard charts
    │   └── layout.py    # Dashboard layout
    ├── gantt/           # Gantt chart components
    │   ├── chart.py     # Gantt chart component
    │   ├── layout.py    # Gantt layout
    │   ├── activity.py  # Activity bars
    │   └── timeline.py  # Timeline utilities
    ├── metrics/         # Metrics visualization
    │   ├── chart.py     # Metrics charts
    │   └── layout.py    # Metrics layout
    └── exporters/       # Export controls
        ├── controls.py  # Export buttons
        └── layout.py    # Export layout
```

### Key Features
- **Real-time Schedule Generation**: Instant schedule creation with different strategies
- **Interactive Controls**: Strategy selection, parameter adjustment
- **Data Persistence**: Save and load schedules with automatic state management
- **Export Capabilities**: PNG, HTML, and SVG export of charts
- **Responsive Design**: Mobile-friendly interface
- **Automatic Environment Setup**: Backend module discovery via PYTHONPATH

## Chart Export System

### Export Functionality
The frontend includes comprehensive chart export capabilities for all visualization components:

- **PNG Export**: High-quality static images using Kaleido engine
- **HTML Export**: Interactive web-ready charts
- **SVG Export**: Scalable vector graphics

### Generated Charts

#### 1. `gantt_chart.png` (Generated by Gantt Layout)
**Purpose**: Visual representation of paper submission timeline
**Content**:
- **Task Bars**: Horizontal bars representing different paper submissions
- **Timeline**: X-axis showing dates (typically months)
- **Task Labels**: Y-axis showing paper titles or submission IDs
- **Color Coding**: Different colors for different submission statuses
- **Sample Data**: Placeholder submissions for testing

#### 2. `dashboard_chart.png` (Generated by Dashboard Layout)
**Purpose**: Overview dashboard showing multiple chart types
**Content**:
- **Multiple Chart Types**: Timeline, Gantt, Resources, Dependencies views
- **Interactive Elements**: Chart type selector
- **Sample Data**: Placeholder data for each chart type
- **Layout**: Clean, organized dashboard interface

#### 3. `metrics_chart.png` (Generated by Metrics Layout)
**Purpose**: Performance metrics and trends visualization
**Content**:
- **Subplot 1**: "Current Performance Metrics" - bar charts showing key metrics
- **Subplot 2**: "Performance Trends" - line charts showing trends over time
- **Metrics**: Submission counts, acceptance rates, timeline adherence
- **Sample Data**: Placeholder metrics for testing purposes

### How Charts Are Generated

These PNG files are created when:

1. **User clicks export buttons** in the frontend interface
2. **Export callbacks are triggered** in the layout components
3. **`export_chart_png()` function** is called with the chart figure
4. **Kaleido engine** renders the Plotly figure as PNG
5. **Files are saved** to the current working directory

### File Naming Convention

The files follow a consistent naming pattern:
- `{component_name}_chart.png`
- Matched the `filename_prefix` parameter in export functions
- Generated in the same directory where the export function was called

### Export Testing and Development

#### For Developers
- **Visual Regression Testing**: Compare new PNGs with existing ones
- **Export Functionality**: Verify PNG generation worked correctly
- **Chart Rendering**: Check that charts displayed properly
- **Sample Data**: Ensure placeholder data rendered correctly

#### For Users
- **Export Verification**: Confirm charts could be saved as images
- **Visual Quality**: Check chart appearance and readability
- **Format Consistency**: Ensure consistent PNG output

### Technical Details

- **Format**: PNG (Portable Network Graphics)
- **Engine**: Kaleido (Plotly's headless image export)
- **Resolution**: Based on chart layout settings
- **File Size**: Varied by chart complexity and data
- **Generation**: On-demand via user interaction

### Troubleshooting

If charts aren't generating:
1. Check that Kaleido is installed: `pip install kaleido`
2. Verify export callbacks are properly connected
3. Check for errors in the browser console
4. Ensure chart figures are valid Plotly objects

## Environment Management

The frontend automatically handles backend module discovery:
- **Automatic Setup**: `run_frontend.py` configures PYTHONPATH automatically
- **Backend Integration**: Seamless access to all backend models and functions
- **Cross-platform**: Works on Windows, macOS, and Linux
- **No Manual Configuration**: Just run the script from the frontend directory

## Development

### Running in Development Mode
```bash
# Enable debug mode for development
python run_frontend.py gantt --debug

# Use custom port for development
python run_frontend.py dashboard --port 8060
```

### Hot Reload
- Changes to Python files auto-reload the server in debug mode
- Check console output for detailed error messages
- Use F12 for client-side debugging

### Testing
```bash
# Run frontend tests
pytest tests/

# Run specific component tests
pytest tests/components/gantt/
pytest tests/components/dashboard/
pytest tests/components/metrics/
```

## Dependencies

### Required Packages
- `dash`: Web application framework
- `plotly`: Interactive plotting library
- `kaleido`: Static image export engine
- `pandas`: Data manipulation
- `numpy`: Numerical computing

### Installation
```bash
# Install frontend dependencies
pip install -r requirements.txt

# Or install specific packages
pip install dash plotly kaleido pandas numpy
```

## Configuration

### Environment Variables
- **Backend Path**: Automatically detected via PYTHONPATH
- **Port Configuration**: Configurable via command line arguments
- **Debug Mode**: Enable/disable via command line flag

### Data Sources
- **Sample Data**: Built-in demo data for testing
- **Backend Integration**: Real data from backend when available
- **State Persistence**: Automatic save/load of user preferences

## Troubleshooting

### Common Issues

**ModuleNotFoundError: No module named 'dash'**
```bash
pip install -r requirements.txt
```

**Port Already in Use**
- Use `--port` flag: `python run_frontend.py gantt --port 8060`
- Or kill the process using the port: `netstat -ano | findstr :8050`

**Frontend Import Issues**
- Make sure you're running from the `frontend/` directory
- The `run_frontend.py` script automatically sets up the environment
- If issues persist, check that `backend/src/` exists relative to frontend

**Chart Export Failures**
- Verify Kaleido is installed: `pip install kaleido`
- Check export callback connections
- Ensure chart figures are valid Plotly objects

### Debug Mode
Use `--debug` flag for detailed error information:
```bash
python run_frontend.py gantt --debug
```

## Future Enhancements

- **Real-time Monitoring**: Live schedule updates and notifications
- **Advanced Export Formats**: PDF, Excel, and other formats
- **Batch Export**: Export all charts simultaneously
- **Custom Themes**: User-configurable chart styling
- **API Integration**: RESTful API for external integrations
- **Mobile App**: Native mobile application
- **Offline Mode**: Work without backend connection
- **Advanced Analytics**: Machine learning insights and recommendations
